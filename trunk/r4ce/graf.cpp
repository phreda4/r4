#include "stdafx.h"// evc 
#include "graf.h"

int tablainc[256]={0x0,0xFF00,0x7F80,0x5500,0x3FC0,0x3300,0x2A80,0x246D,0x1FE0,0x1C55,0x1980,0x172E,0x1540,0x139D,0x1236,0x1100,
0xFF0,0xF00,0xE2A,0xD6B,0xCC0,0xC24,0xB97,0xB16,0xAA0,0xA33,0x9CE,0x971,0x91B,0x8CB,0x880,0x839,
0x7F8,0x7BA,0x780,0x749,0x715,0x6E4,0x6B5,0x689,0x660,0x638,0x612,0x5EE,0x5CB,0x5AA,0x58B,0x56C,
0x550,0x534,0x519,0x500,0x4E7,0x4CF,0x4B8,0x4A2,0x48D,0x479,0x465,0x452,0x440,0x42E,0x41C,0x40C,
0x3FC,0x3EC,0x3DD,0x3CE,0x3C0,0x3B2,0x3A4,0x397,0x38A,0x37E,0x372,0x366,0x35A,0x34F,0x344,0x33A,
0x330,0x325,0x31C,0x312,0x309,0x300,0x2F7,0x2EE,0x2E5,0x2DD,0x2D5,0x2CD,0x2C5,0x2BD,0x2B6,0x2AF,
0x2A8,0x2A0,0x29A,0x293,0x28C,0x286,0x280,0x279,0x273,0x26D,0x267,0x262,0x25C,0x256,0x251,0x24C,
0x246,0x241,0x23C,0x237,0x232,0x22D,0x229,0x224,0x220,0x21B,0x217,0x212,0x20E,0x20A,0x206,0x202,
0x1FE,0x1FA,0x1F6,0x1F2,0x1EE,0x1EA,0x1E7,0x1E3,0x1E0,0x1DC,0x1D9,0x1D5,0x1D2,0x1CE,0x1CB,0x1C8,
0x1C5,0x1C2,0x1BF,0x1BC,0x1B9,0x1B6,0x1B3,0x1B0,0x1AD,0x1AA,0x1A7,0x1A5,0x1A2,0x19F,0x19D,0x19A,
0x198,0x195,0x192,0x190,0x18E,0x18B,0x189,0x186,0x184,0x182,0x180,0x17D,0x17B,0x179,0x177,0x175,
0x172,0x170,0x16E,0x16C,0x16A,0x168,0x166,0x164,0x162,0x160,0x15E,0x15D,0x15B,0x159,0x157,0x155,
0x154,0x152,0x150,0x14E,0x14D,0x14B,0x149,0x148,0x146,0x144,0x143,0x141,0x140,0x13E,0x13C,0x13B,
0x139,0x138,0x136,0x135,0x133,0x132,0x131,0x12F,0x12E,0x12C,0x12B,0x12A,0x128,0x127,0x126,0x124,
0x123,0x122,0x120,0x11F,0x11E,0x11D,0x11B,0x11A,0x119,0x118,0x116,0x115,0x114,0x113,0x112,0x111,
0x110,0x10E,0x10D,0x10C,0x10B,0x10A,0x109,0x108,0x107,0x106,0x105,0x104,0x103,0x102,0x101,0x100};


//---- variables externas
DWORD *gr_buffer;		// buffer de pantalla
int gr_sizescreen;	// tamanio de pantalla
int gr_ancho,gr_alto;

WORD gr_color1,gr_color2,col1,col2;
int gr_ypitch;
int MA,MB,MTX,MTY; // matrix de transformacion
int *mTex; // textura

//---- variables para dibujo de poligonos
typedef struct { int y,x,yfin,deltax; } Segm;
Segm segmentos[1024];
Segm **pact;
Segm *actual[256]; // segmentos actuales
Segm **xquisc;
Segm *xquis[256]; // cada linea
int cntSegm=0;
int yMin,yMax;
BYTE gr_alphav;

//---- variables internas
WORD colorr,colorg,colorb;// optimiza color 1

//--- rutinas de redraw
void (*gr_redraw)(void);// rutina de redraw
void (*gr_drawre)(void);// copia pantalla a buffer

void gr_clrscr(void)
{
register DWORD col=(gr_color2<<16)+gr_color2;
register DWORD *pp=gr_buffer;
register DWORD *pf=gr_buffer+gr_sizescreen;
do {
	*pp=col;pp++;*pp=col;pp++;*pp=col;pp++;*pp=col;pp++;
	*pp=col;pp++;*pp=col;pp++;*pp=col;pp++;*pp=col;pp++;
} while (pp<pf);
}

void gr_redraw565(void)
{
register DWORD *pbuffer=(DWORD*)GXBeginDraw();
register DWORD *punt,*ult;
while (pbuffer==NULL) {// se detiene cuando lo interrumpen
	update();
	pbuffer=(DWORD*)GXBeginDraw();
	};
punt=gr_buffer;ult=gr_buffer+gr_sizescreen;// -7
do {
	*pbuffer++=*punt++;*pbuffer++=*punt++;*pbuffer++=*punt++;*pbuffer++=*punt++;
	*pbuffer++=*punt++;*pbuffer++=*punt++;*pbuffer++=*punt++;*pbuffer++=*punt++;
} while (punt<ult);
GXEndDraw();
}

void gr_redraw888(void)
{
}


WORD RED_MASK,GREEN_MASK,BLUE_MASK;

//---- rutinas de inicio
int gr_init(void)
{
GXDisplayProperties disp=GXGetDisplayProperties();
gr_ancho=disp.cxWidth;
gr_alto=disp.cyHeight;
//gr_xpitch=disp.cbxPitch>>1;
gr_ypitch=disp.cbyPitch>>1;
gr_sizescreen=(gr_ancho*gr_alto)>>1;// tamanio en DWORD
//---- poligonos2
cntSegm=0;
yMin=gr_alto+1;
yMax=-1;
fillSol();

gr_buffer=new DWORD[gr_sizescreen];//gr_buffer=(DWORD*)LocalAlloc(LMEM_FIXED,gr_sizescreen);
if (gr_buffer==NULL) return -1;// no hay memoria
//---- colores

if (disp.ffFormat|kfDirect565) {		
	gr_redraw=gr_redraw565;//	gr_drawre=gr_drawre565;
	RED_MASK=0xF800;GREEN_MASK=0x07E0;BLUE_MASK=0x001F;
} else if (disp.ffFormat|kfDirect555) { 
	gr_redraw=gr_redraw565;
	RED_MASK=0xFC00;GREEN_MASK=0x03E0;BLUE_MASK=0x001F;
} else if (disp.ffFormat|kfDirect888) { 
	gr_redraw=gr_redraw888;
}
//---- colores
gr_alphav=0xff;
gr_color2=0;gr_color1=0xffff;
col1=0;col2=0xffff;
gr_solid();

return 0;
}

void gr_fin(void)
{
delete gr_buffer;
}

WORD gr_RGB(DWORD c) 
{
colorr=(WORD)((c>>8)&RED_MASK);
colorg=(WORD)((c>>5)&GREEN_MASK);
colorb=(WORD)((c>>3)&BLUE_MASK);
return (colorr|colorg|colorb);
};

DWORD RGB_gr(WORD c)
{
register DWORD c1=(c&RED_MASK);c1=(c1|(c1>>5))<<8;
register DWORD a=c1&0xff0000;
c1=(c&GREEN_MASK);c1=((c1<<6)|c1)>>1;
a|=c1&0xff00;
c1=(c&BLUE_MASK);c1=((c1<<5)|c1)>>2;
return (a|(c1&0xff));
}

WORD gr_565(WORD c)
{
colorr=(WORD)(c&RED_MASK);
colorg=(WORD)(c&GREEN_MASK);
colorb=(WORD)(c&BLUE_MASK);
return c;//(colorr|colorg|colorb);
}

//--------------- RUTINAS DE DIBUJO
/*
inline DWORD gr_mix(DWORD c1,DWORD c2,BYTE alpha)// alpha esta en color
{
DWORD r1,r2,r,g1,g2,g,b1,b2,b;
b1=c1&0xff;b2=c2&0xff;
b=(((b2-b1)*alpha+(b1<<8))>>8)&0xff;
g1=c1&0xff00;g2=c2&0xff00;
g=(((g2-g1)*alpha+(g1<<8))>>8)&0xff00;
r1=c1&0xff0000;r2=c2&0xff0000;
r=(((r2-r1)*alpha+(r1<<8))>>8)&0xff0000;
return (r|g|b);
}
/*/
inline WORD gr_mix(WORD col,BYTE alpha)
{
WORD r=(col&RED_MASK);
r=(((colorr-r)*alpha+(r<<8))>>8)&RED_MASK;
WORD g=(col&GREEN_MASK);
g=(((colorg-g)*alpha+(g<<8))>>8)&GREEN_MASK;
WORD b=(col&BLUE_MASK);
b=(((colorb-b)*alpha+(b<<8))>>8)&BLUE_MASK;
return (WORD)(r|g|b);
}

/*


#define MASK1 (RED_MASK|BLU_MASK)
#define MASK2 (GRE_MASK)

inline DWORD gr_mix(DWORD col,BYTE alpha)
{
register DWORD B=(col & MASK1);
register DWORD RB=(((((gr_color1&MASK1)-B)*alpha)>>8)+B)&MASK1;
B=col&MASK2;
return ((((((gr_color1&MASK2)-B)*alpha)>>8)+B)&MASK2)|RB;
}
*/
//--------------- RUTINAS DE DIBUJO
//---- solido
void _gr_pixels(WORD *gr_pos) {*gr_pos=gr_color1;}
void _gr_pixela(WORD *gr_pos,BYTE a) {*gr_pos=gr_mix(*gr_pos,a);}

//---- solido con alpha
void _gr_pixelsa(WORD *gr_pos)	{*gr_pos=gr_mix(*gr_pos,gr_alphav);}
void _gr_pixelaa(WORD *gr_pos,BYTE a) {*gr_pos=gr_mix(*gr_pos,(BYTE)((WORD)(a*gr_alphav)>>8));}

//---- gradiente lineal
void _gr_pixelsld(WORD *gr_pos)	 {BYTE alpha=255;*gr_pos=gr_mix(*gr_pos,alpha);}
void _gr_pixelald(WORD *gr_pos,BYTE a) {*gr_pos=gr_mix(*gr_pos,a);}

//---- gradiente radial
void _gr_pixelsrd(WORD *gr_pos)	{BYTE alpha=255;*gr_pos=gr_mix(*gr_pos,alpha);}
void _gr_pixelard(WORD *gr_pos,BYTE a) {*gr_pos=gr_mix(*gr_pos,a);}

//--------------- RUTINAS DE DIBUJO
void (*gr_pixel)(WORD *gr_pos);
void (*gr_pixela)(WORD *gr_pos,BYTE a);

void gr_solid(void) {gr_pixel=_gr_pixels;gr_pixela=_gr_pixela;gr_alphav=255;}
void gr_alpha(void) {gr_pixel=_gr_pixelsa;gr_pixela=_gr_pixelaa;}

//--------------- DIBUJO DE POLIGONO
void _FlineaSolido(int y,Segm *m1,Segm *m2);
void _FlineaDL(int y,Segm *m1,Segm *m2);
void _FlineaDR(int y,Segm *m1,Segm *m2);
void _FlineaTX(int y,Segm *m1,Segm *m2);

void (*fillpoly)(int y,Segm *m1,Segm *m2);

void fillSol(void) { fillpoly=_FlineaSolido; }
void fillLin(void) { fillpoly=_FlineaDL; }
void fillRad(void) { fillpoly=_FlineaDR; }
void fillTex(void) { fillpoly=_FlineaTX; }

//------------------------------------
#define GR_SET(X,Y) gr_pos=(WORD*)gr_buffer+Y*gr_ypitch+X;
#define GR_X(X) gr_pos+=X;
#define GR_Y(Y) gr_pos+=gr_ancho*Y;
//------------------------------------
void gr_hlined(int x1,int y1,int x2,BYTE a1,BYTE a2)
{
int alpha=a1<<8;
int da=((a2-a1)<<8)/(x2-x1);
if (x1<0) { alpha+=da*(-x1);x1=0; }
if (x2>=gr_ancho) { x2=gr_ancho-1;if (x1>=gr_ancho) return; }
register WORD *gr_pos;
GR_SET(x1,y1);
WORD *pf=gr_pos+x2-x1+1;
do {
	gr_pixela(gr_pos,alpha>>8);
	gr_pos++;alpha+=da;
} while (gr_pos<pf);
}

void gr_vlined(int x1,int y1,int y2,BYTE a1,BYTE a2)
{
int alpha=(a1<<8);
int da=((a2-a1)<<8)/(y2-y1);
if (y1<0) { alpha+=da*(-y1);y1=0; }
if (y2>=gr_alto) { y2=gr_alto-1;if (y1>=gr_alto) return; }
register WORD *gr_pos;
GR_SET(x1,y1);
WORD *pf=gr_pos+((y2-y1+1)*gr_ancho);
do {
	gr_pixela(gr_pos,alpha>>8);
	gr_pos+=gr_ancho;alpha+=da;
} while (gr_pos<pf);
}

//---- clip
void gr_hline(int x1,int y1,int x2)
{
if (x1<0) x1=0;
if (x2>=gr_ancho) { x2=gr_ancho-1;if (x1>=gr_ancho) return; }
register WORD *gr_pos;
GR_SET(x1,y1);
WORD *pf=gr_pos+x2-x1+1;
do {
	gr_pixel(gr_pos);gr_pos++;
} while (gr_pos<pf);
}

void gr_vline(int x1,int y1,int y2)
{
if (y1<0) y1=0;
if (y2>=gr_alto) { y2=gr_alto-1;if (y1>=gr_alto) return; }
register WORD *gr_pos;
GR_SET(x1,y1);
WORD *pf=gr_pos+((y2-y1+1)*gr_ancho);
do {
	gr_pixel(gr_pos);gr_pos+=gr_ancho;
} while (gr_pos<pf);
}

bool gr_clipline(int *X1,int *Y1,int *X2,int *Y2)
{
int C1,C2;
int V;
if (*X1<0) C1=1; else C1=0;
if (*X1>=gr_ancho) C1|=0x2;
if (*Y1<0) C1|=0x4;
if (*Y1>=gr_alto) C1|=0x8;
if (*X2<0) C2=1; else C2=0;
if (*X2>=gr_ancho) C2|=0x2;
if (*Y2<0) C2|=0x4;
if (*Y2>=gr_alto) C2|=0x8;
if ((C1&C2)==0 && (C1|C2)!=0) 
	{
	if ((C1&12)!=0)
		{
		if (C1<8) V=0; else V=gr_alto-1;
		*X1+=(V-*Y1)*(*X2-*X1)/(*Y2-*Y1);
		*Y1=V;
		if (*X1<0) C1=1; else C1=0;
		if (*X1>=gr_ancho) C1|=0x2;
		}
    if ((C2&12)!=0)
		{
		if (C2<8) V=0; else V=gr_alto-1;
		*X2+=(V-*Y2)*(*X2-*X1)/(*Y2-*Y1);
		*Y2=V;
		if (*X2<0) C2=1; else C2=0;
		if (*X2>=gr_ancho) C2|=0x2;
		}
    if ((C1&C2)==0 && (C1|C2)!=0) 
		{
		if (C1!=0)
			{
			if (C1==1) V=0; else V=gr_ancho-1;
			*Y1+=(V-*X1)*(*Y2-*Y1)/(*X2-*X1);
			*X1=V;C1=0;
			}
		if (C2!=0)
			{
			if (C2==1) V=0; else V=gr_ancho-1;
			*Y2+=(V-*X2)*(*Y2-*Y1)/(*X2-*X1);
			*X2=V;C2=0;
			}
		}
	}
return (C1|C2)==0;
}

//---- con clip
inline void gr_setpixel(int x,int y)
{
if ((unsigned)x>=(unsigned)gr_ancho || (unsigned)y>=(unsigned)gr_alto) return;
register WORD *gr_pos;
GR_SET(x,y);gr_pixel(gr_pos);
}

inline void gr_setpixela(int x,int y,BYTE a)
{
if ((unsigned)x>=(unsigned)gr_ancho || (unsigned)y>=(unsigned)gr_alto) return;
register WORD *gr_pos;
GR_SET(x,y);gr_pixela(gr_pos,a);
}


inline void swap(int &a,int &b)
{
int t=a;a=b;b=t;
}
inline int absi(int a ) { return (a+(a>>31))^(a>>31); }
inline int recta(int a1,int a2,int a3,int a4) { return absi(a1*a2-a3*a4); }


void gr_line(int x1,int y1,int x2,int y2)
{
if (!gr_clipline(&x1,&y1,&x2,&y2)) return;
int dx,dy,sx,d;
if (x1==x2) { 
	if (y1>y2) swap(y1,y2);
	gr_vline(x1,y1,y2);return;
	}
if (y1==y2) { 
	if (x1>x2) swap(x1,x2);
	gr_hline(x1,y1,x2);return;
	};
if (y1>y2) { swap(x1,x2);swap(y1,y2); }            
dx=x2-x1;dy=y2-y1;
if (dx>0) sx=1; else { sx=-1;dx=-dx;}
//if (dy>0) sy=1; else { sy=-1;dy=-dy;}
WORD ea,ec=0;BYTE ci;
register WORD *gr_pos;
GR_SET(x1,y1);gr_pixel(gr_pos);
if (dy>dx) 	{
	ea=(dx<<16)/dy;
    while (dy>0) {
        dy--;d=ec;ec+=ea;if (ec<=d) x1+=sx;
        y1++;ci=ec>>8;
		GR_SET(x1,y1);gr_pixela(gr_pos,255-ci);GR_X(sx);gr_pixela(gr_pos,ci);
		}
} else {// DY <= DX
    ea=(dy<<16)/dx;
    while (dx>0) {
        dx--;d=ec;ec+=ea;if (ec<=d) y1++;
        x1+=sx;ci=ec>>8;
		GR_SET(x1,y1);gr_pixela(gr_pos,255-ci);
		if (y1<=gr_alto-2) { GR_Y(1);gr_pixela(gr_pos,ci); }
		}
	}
}

void gr_pline(int x1,int y1,int x2,int y2,WORD t)
{
if (!gr_clipline(&x1,&y1,&x2,&y2)) return;
int dx,dy,xinc,yinc,s,dx2,dy2,dxy,x,y;
if (x1<x2) xinc=1; else xinc=-1;
dx=absi(x1-x2);
if (y1<y2) yinc=1; else yinc=-1;
dy=absi(y1-y2);
dx2=dx+dx;dy2=dy+dy;
x=x1;y=y1;
WORD mask=0x2;
register WORD *gr_pos;
if ((t&1)!=0) { GR_SET(x,y);gr_pixel(gr_pos); }
if (dx>dy) {
	s = dy2 - dx;
	dxy = dy2 - dx2;
	for (int i=1;i<dx+1;i++) {
		if (s>=0) { y+=yinc;s+=dxy; }	else s+=dy2;
		x+=xinc;
		if ((t&mask)!=0) { GR_SET(x,y);gr_pixel(gr_pos); }
		if (mask==0x8000) mask=0x1; else mask<<=1;
		}
} else {
	s = dx2 - dy;
	dxy = dx2 - dy2;
	for (int i=1;i<dy+1;i++) {
		if (s>=0) { x+=xinc;s+=dxy; }	else s+=dx2;
		y+=yinc;
		if ((t&mask)!=0) { GR_SET(x,y);gr_pixel(gr_pos); }
		if (mask==0x8000) mask=0x1; else mask<<=1;
		}
	}
}

void gr_splineiter(int x1,int y1,int x2,int y2,int x3,int y3)
{
if (recta(x2-x1,y3-y1,x3-x1,y2-y1)<1000)
    { gr_line(x1>>4,y1>>4,x3>>4,y3>>4); return; }
int x11=(x1+x2)>>1,y11=(y1+y2)>>1;
int x21=(x2+x3)>>1,y21=(y2+y3)>>1;
int x22=(x11+x21)>>1,y22=(y11+y21)>>1;
gr_splineiter(x1,y1,x11,y11,x22,y22);
gr_splineiter(x22,y22,x21,y21,x3,y3);
}

void gr_spline(int x1,int y1,int x2,int y2,int x3,int y3)
{
gr_splineiter(x1<<4,y1<<4,x2<<4,y2<<4,x3<<4,y3<<4);
}

void gr_splinec(int x1,int y1,int x2,int y2,int x3,int y3)
{
int mx,my;
mx=(x1+x3)>>1;my=(y1+y3)>>1;
x2=mx+((x2-mx)<<1);y2=my+((y2-my)<<1);
gr_splineiter(x1<<4,y1<<4,x2<<4,y2<<4,x3<<4,y3<<4);
}

void gr_box(int x1,int y1,int x2,int y2)
{
if (y1>y2) swap(y1,y2);
if (x1>x2) swap(x1,x2);
if (x2<0 || y2<0 || x1>=gr_ancho || y1>=gr_alto) return;
if ((unsigned)y1<(unsigned)gr_alto) gr_hline(x1,y1,x2);
if ((unsigned)y2<(unsigned)gr_alto) gr_hline(x1,y2,x2);
y1++;y2--;
if ((unsigned)x1<(unsigned)gr_ancho) gr_vline(x1,y1,y2);
if ((unsigned)x2<(unsigned)gr_ancho) gr_vline(x2,y1,y2);
}

void gr_fbox(int x1,int y1,int x2,int y2)
{
if (y1>y2) swap(y1,y2);
if (x1>x2) swap(x1,x2);
if (x2<0 || y2<0 || x1>=gr_ancho || y1>=gr_alto) return;
if (x1<0) x1=0;
if (y1<0) y1=0;
if (x2>=gr_ancho)	x2=gr_ancho-1;
if (y2>=gr_alto)	y2=gr_alto-1;
register WORD *gr_pos;
register WORD *pf;
register WORD cnt=x2-x1;
register int y=y1;
do {
	GR_SET(x1,y);pf=gr_pos+cnt;
	do { gr_pixel(gr_pos);gr_pos++; } while (gr_pos<=pf);
	y++;
} while (y<=y2);
}

void gr_fboxv(int x1,int y1,int x2,int y2)
{
if (y1>y2) swap(y1,y2);
if (x1>x2) swap(x1,x2);
if (x2<0 || y2<0 || x1>=gr_ancho || y1>=gr_alto) return;
WORD a1=0,a2=0xff;// unpack FFFF ff 00 // skew - in - out
register int x=x1;
do { gr_vlined(x,y1,y2,(BYTE)a1,(BYTE)a2);x++; } while (x<=x2);
}

void gr_fboxh(int x1,int y1,int x2,int y2)
{
if (y1>y2) swap(y1,y2);
if (x1>x2) swap(x1,x2);
if (x2<0 || y2<0 || x1>=gr_ancho || y1>=gr_alto) return;
register int y=y1;
WORD a1=0,a2=0xff;// unpack FFFF ff 00 // skew - in - out
do { gr_hlined(x1,y,x2,(BYTE)a1,(BYTE)a2);y++; } while (y<=y2);
}

void gr_circle(int x,int y,int r)
{
if (r<2)
	{
	gr_setpixel(x,y);
	return;
	}
int cx=0,cy=r;
int df=1-r; 
int d_e=3;
int d_se=-2*r+5;
bool cambio=false;
WORD al;
do {
	al=(absi(df)<<8)/absi(d_e);
	gr_setpixel(x+cx,y+cy);//gr_setpixela(x+cx,y+cy,al);DecXPos();SPixelA(255-al);
	if (cx)	{ gr_setpixel(x-cx,y+cy);}//;IncYPos();SPixelA(255-al); }
    if (cy)	{ gr_setpixel(x+cx,y-cy);}//,255-al);IncXPos();SPixelA(al); }
    if ((cx) && (cy)) { gr_setpixel(x-cx,y-cy); }
    if (cx!=cy) 
		{
		gr_setpixel(x+cy,y+cx);
		if (cx) gr_setpixel(x+cy,y-cx);
		if (cy) gr_setpixel(x-cy,y+cx);
		if (cx && cy) gr_setpixel(x-cy,y-cx);
		}
    if (df<0)  
		{df+=d_e;d_e +=2;d_se+=2;}
	else 
		{df+=d_se;d_e+=2;d_se+=4;cy--;} 
	cx++; 
} while (cx<=cy);
}

void gr_fillcircle(int x,int y,int r)
{
if (r<1)
	{
	gr_setpixel(x,y);
	return;
	}
int cx=0,cy=r,cxa;
int df=1-r; 
int d_e=3;
int d_se=-2*r+5;
int c=1;
WORD al,dal,j;
byte ci;
do {
// al=abs(df)*255/(1-r);gr_setpixela(x-cy,y-cx,al);gr_setpixela(x-cy,y+cx,al);
	if (cy>0 && (unsigned)(y+cx)<(unsigned)gr_alto) gr_hline(x-cy+1,y+cx,x+cy-1);
	if (cx>0 && (unsigned)(y-cx)<(unsigned)gr_alto) gr_hline(x-cy+1,y-cx,x+cy-1);
    if (df<0)  
		{df+=d_e;d_e +=2;d_se+=2;c++;}
	else 
		{
		al=dal=(gr_alphav<<8)/c;
		for (j=0;j<c;j++)
			{
			ci=al>>8;
			gr_setpixela(x-cx+j,y-cy,ci);gr_setpixela(x-cx+j,y+cy,ci);
			gr_setpixela(x-cy,y+cx-j,ci);gr_setpixela(x-cy,y-cx+j,ci);
			gr_setpixela(x+cx-j,y-cy,ci);gr_setpixela(x+cx-j,y+cy,ci);
			gr_setpixela(x+cy,y+cx-j,ci);gr_setpixela(x+cy,y-cx+j,ci);
			al+=dal;
			}
		if (cx>c && cy!=cx)
			{
			cxa=cx-c;
			if ((unsigned)(y-cy)<(unsigned)gr_alto) gr_hline(x-cxa,y-cy,x+cxa);
			if ((unsigned)(y+cy)<(unsigned)gr_alto) gr_hline(x-cxa,y+cy,x+cxa);
			}
		c=1;
		df+=d_se;d_e+=2;d_se+=4;cy--;
		} 
	cx++; 
} while (cx<=cy);
}

// poligono
void gr_iteracionSP(long x1,long y1,long x2,long y2,long x3,long y3)
{//dist(x1,y1,x3,y3)<(4<<4)){//angle(x1,y1,x2,y2,x3,y3)<100) {
if (recta(x1,y1,x2,y2,x3,y3)<1000){	gr_psegmento(x1>>4,y1>>4,x3>>4,y3>>4);return;}
long x11=(x1+x2)>>1,y11=(y1+y2)>>1;
long x21=(x2+x3)>>1,y21=(y2+y3)>>1;
long x22=(x11+x21)>>1,y22=(y11+y21)>>1;
gr_iteracionSP(x1,y1,x11,y11,x22,y22);
gr_iteracionSP(x22,y22,x21,y21,x3,y3);
}

void gr_pspline(int x1,int y1,int x2,int y2,int x3,int y3)
{
gr_iteracionSP(x1<<4,y1<<4,x2<<4,y2<<4,x3<<4,y3<<4);
}

void gr_psplinec(int x1,int y1,int x2,int y2,int x3,int y3)
{
int mx=(x1+x3)>>1;int my=(y1+y3)>>1;
x2=mx+((x2-mx)<<1);y2=my+((y2-my)<<1);
gr_iteracionSP(x1<<4,y1<<4,x2<<4,y2<<4,x3<<4,y3<<4);
}

//**************************************************
//***** DIBUJO DE POLIGONO
//**************************************************
#define FBASE 8

void gr_psegmento(int x1,int y1,int x2,int y2)
{
int t;
if (y1==y2) return;
if (y1>y2) { t=x1;x1=x2;x2=t;t=y1;y1=y2;y2=t; }
if (y1>=gr_alto || y2<=0) return;
x1=x1<<FBASE;
x2=x2<<FBASE;
t=(x2-x1)/(y2-y1);
if (y1<0) { x1+=t*(-y1);y1=0; }
if (yMin>y1) yMin=y1;
if (yMax<y2) yMax=y2;
Segm *ii=&segmentos[cntSegm-1];
while (ii>=segmentos && ii->y>y1 ) {
  *(ii+1)=*(ii);ii--;
  }
ii++;
ii->x=x1+((1<<FBASE)>>1);
ii->y=y1;
ii->yfin=y2;
ii->deltax=t;
cntSegm++;
}

/*
void gr_psegmento(int x1,int y1,int x2,int y2)
{
gr_segpoli *s;
int dx,x,ymin,ymax;
if (y1==y2) return;
if (y1<y2) { ymin=y1;ymax=y2;} else { ymin=y2;ymax=y1;swap(x1,x2); }
if (ymax<=0 || ymin>=gr_alto ) return;
x=(x1<<SEGFRAC);
dx=((x2-x1)<<SEGFRAC)/(ymax-ymin);
if (ymin<0) { x+=dx*(-ymin);ymin=0; }
if (ymax>gr_alto) ymax=gr_alto;//-1 (**1)
if ((gr_linact-gr_seg)>=NB_SEGMENT_MAX) return;
s=gr_linact++;
s->next=s->nextValid=0;s->ymax=ymax;s->x=x;s->dx=dx;
if (ymin<gr_limymin) gr_limymin=ymin;
if (ymax>gr_limymax) gr_limymax=ymax;
if (gr_lines[ymin]==NULL) gr_lines[ymin]=s;
else {
    gr_segpoli *act,*prev;prev=0;
    for(act=gr_lines[ymin];act;prev=act,act=act->next) {
        if ((act->x+act->dx)>(s->x+s->dx)) {
            if (prev) { prev->next=s;s->next=act; } 
			else { s->next=gr_lines[ymin];gr_lines[ymin]=s; }
            break;
            }
        }
	if (act==0) { prev->next=s;s->next=act; }
    }
}
*/
//-------------------------------------------------
void _FlineaSolido(int y,Segm *m1,Segm *m2)
{
register WORD *gr_pos;
register int cnt,alpha,da;
int x1,x2,x3,x4;
if (m1->deltax<0)
   { x1=m1->x+m1->deltax;x2=m1->x; }
else
   { x1=m1->x;x2=m1->x+m1->deltax; }
if (m2->deltax<0)
   { x3=m2->x+m2->deltax;x4=m2->x; }
else
   { x3=m2->x;x4=m2->x+m2->deltax; }
int ex1=x1>>FBASE,ex2=x2>>FBASE;
int ex3=x3>>FBASE,ex4=x4>>FBASE;
if (ex4<=0 || ex1>=gr_ancho ) return;
if (ex1>0) GR_SET(ex1,y) else GR_SET(0,y)

gr_color1=0xff0;
if (ex2>0) { // entrada anti
  if (ex1==ex2) { // punto solo
    gr_pixela(gr_pos,255-(BYTE)((x1+x2)>>1));gr_pos++;
  } else { // degrade
    alpha=0;//    da=(255<<8)/(ex2-ex1);
    da=(ex2-ex1);
    if (da>0xff) da=tablainc[(da>>8)&0xff]>>8; else da=tablainc[da];

    if (ex1<0) { alpha+=da*(-ex1);ex1=0; }
    if (ex2>=gr_ancho) ex2=gr_ancho-1;
    cnt=ex2-ex1+1;
    while (cnt--) { gr_pixela(gr_pos,alpha>>8);gr_pos++;alpha+=da; }
    }
  }

//if (ex3<ex2) return;
if (ex3<=ex2) return;

gr_color1=0xff;
if (ex3>0) { // lleno
    if (ex2<0) ex2=0;
    if (ex3>gr_ancho) ex3=gr_ancho;
    cnt=ex3-ex2-1;
    while (cnt--) { gr_pixel(gr_pos);gr_pos++; }
  }
gr_color1=0xff00;
if (ex4==ex3) { // punto solo
  gr_pixela(gr_pos,(BYTE)((x3+x4)>>1));
} else { // degrade
  alpha=255<<8;//da=(-255<<8)/(ex4-ex3);

  da=(ex4-ex3);
  if (da>0xff) da=-tablainc[(da>>8)&0xff]>>8; else da=-tablainc[da];

  if (ex3<0) { alpha+=da*(-ex3);ex3=0; }    
  if (ex4>gr_ancho) ex4=gr_ancho;
  cnt=ex4-ex3;
  while (cnt--) { gr_pixela(gr_pos,alpha>>8);gr_pos++;alpha+=da; }
  }
}

//-------------------------------------------------
inline void mixcolor(WORD col1,WORD col2,int niv)
{
//niv=niv&0xff;
//niv=abs(niv);
if (niv<1) { gr_color1=col2;return; }
gr_color1=col1;
if (niv>254) return;
gr_color1=gr_mix(col2,niv);
}

void _FlineaDL(int y,Segm *m1,Segm *m2)
{
register WORD *gr_pos;
register int cnt,alpha,da;
int x1,x2,x3,x4;
if (m1->deltax<0)
   { x1=m1->x+m1->deltax;x2=m1->x; }
else
   { x2=m1->x+m1->deltax;x1=m1->x; }
if (m2->deltax<0)
   { x3=m2->x+m2->deltax;x4=m2->x; }
else
   { x4=m2->x+m2->deltax;x3=m2->x; }
int ex1=x1>>FBASE,ex2=x2>>FBASE;
int ex3=x3>>FBASE,ex4=x4>>FBASE;
if (ex4<=0 || ex1>=gr_ancho ) return;
int r=MA*(ex2-MTX)-MB*(y-MTY);
mixcolor(col1,col2,r>>8);
if (ex1>0) GR_SET(ex1,y) else GR_SET(0,y)

if (ex2>0) { // entrada anti
  if (ex1==ex2) { // punto solo
    gr_pixela(gr_pos,255-(BYTE)((x1+x2)>>1));gr_pos++;
  } else { // degrade
    alpha=0;//da=(255<<8)/(ex2-ex1);
    da=(ex2-ex1);
    if (da>0xff) da=tablainc[(da>>8)&0xff]>>8; else da=tablainc[da];

    if (ex1<0) { alpha+=da*(-ex1);ex1=0; }
    if (ex2>=gr_ancho) ex2=gr_ancho-1;
    cnt=ex2-ex1+1;
    while (cnt--) { gr_pixela(gr_pos,alpha>>8);gr_pos++;alpha+=da; }
    }
  }

if (ex3<=ex2) return;
if (ex3>0) { // lleno
    if (ex2<0) { r+=MA*(-ex2);ex2=0; }
    if (ex3>gr_ancho) ex3=gr_ancho;
    cnt=ex3-ex2-1;
    while (cnt--) { 
        mixcolor(col1,col2,r>>8);
        gr_pixel(gr_pos);gr_pos++; 
        r+=MA;
        }
  }
if (ex4==ex3) { // punto solo
  gr_pixela(gr_pos,(BYTE)((x3+x4)>>1));
} else { // degrade
  alpha=255<<8;//da=(-255<<8)/(ex4-ex3);
  da=(ex4-ex3);
  if (da>0xff) da=-tablainc[(da>>8)&0xff]>>8; else da=-tablainc[da];

  if (ex3<0) { alpha+=da*(-ex3);ex3=0; }    
  if (ex4>gr_ancho) ex4=gr_ancho;
  cnt=ex4-ex3;
  while (cnt--) { gr_pixela(gr_pos,alpha>>8);gr_pos++;alpha+=da; }
  }
}

//---------------------------------------------------
inline int dist(int dx,int dy)
{
//return abs(dx)+abs(dy);
register int min,max;
dx=absi(dx);dy=absi(dy);
if (dx<dy) { min=dx;max=dy; } else { min=dy;max=dx; }
return ((max<<8)+(max<<3)-(max<<4)-(max<<1)+
        (min<<7)-(min<<5)+(min<<3)-(min<<1));
}

void _FlineaDR(int y,Segm *m1,Segm *m2)
{
register WORD *gr_pos;
register int cnt,alpha,da;
int x1,x2,x3,x4;
if (m1->deltax<0)
   { x1=m1->x+m1->deltax;x2=m1->x; }
else
   { x2=m1->x+m1->deltax;x1=m1->x; }
if (m2->deltax<0)
   { x3=m2->x+m2->deltax;x4=m2->x; }
else
   { x4=m2->x+m2->deltax;x3=m2->x; }
int ex1=x1>>FBASE,ex2=x2>>FBASE;
int ex3=x3>>FBASE,ex4=x4>>FBASE;
if (ex4<=0 || ex1>=gr_ancho ) return;
int rx = MA*(ex2-MTX)-MB*(y-MTY);
int ry = MB*(ex2-MTX)+MA*(y-MTY);
mixcolor(col1,col2,dist(rx,ry)>>16);
if (ex1>0) GR_SET(ex1,y) else GR_SET(0,y)
if (ex2>0) { // entrada anti
  if (ex1==ex2) { // punto solo
    gr_pixela(gr_pos,255-(BYTE)((x1+x2)>>1));gr_pos++;
  } else { // degrade
    alpha=0;//da=(255<<8)/(ex2-ex1);
    da=(ex2-ex1);
    if (da>0xff) da=tablainc[(da>>8)&0xff]>>8; else da=tablainc[da];

    if (ex1<0) { alpha+=da*(-ex1);ex1=0; }
    if (ex2>=gr_ancho) ex2=gr_ancho-1;
    cnt=ex2-ex1+1;
    while (cnt--) { gr_pixela(gr_pos,alpha>>8);gr_pos++;alpha+=da; }
    }
  }
if (ex3<=ex2) return;
if (ex3>0) { // lleno
    if (ex2<0) { rx+=MA*(-ex2);ry+=MB*(-ex2);ex2=0; }
    if (ex3>gr_ancho) ex3=gr_ancho;
    cnt=ex3-ex2-1;
    while (cnt--) {
        mixcolor(col1,col2,dist(rx,ry)>>16);
        gr_pixel(gr_pos);gr_pos++; 
        rx+=MA;
        ry+=MB;
        }
  }
if (ex4==ex3) { // punto solo
  gr_pixela(gr_pos,(BYTE)((x3+x4)>>1));
} else { // degrade
  alpha=255<<8;//da=(-255<<8)/(ex4-ex3);
  da=(ex4-ex3);
  if (da>0xff) da=-tablainc[(da>>8)&0xff]>>8; else da=-tablainc[da];

  if (ex3<0) { alpha+=da*(-ex3);ex3=0; }    
  if (ex4>gr_ancho) ex4=gr_ancho;
  cnt=ex4-ex3;
  while (cnt--) { gr_pixela(gr_pos,alpha>>8);gr_pos++;alpha+=da; }
  }
}

//---------------------------------------------------
inline void texture(int dx,int dy)
{
gr_color1=((int*)mTex)[(dx>>8)&0xff|(dy&0xff00)];
}

void _FlineaTX(int y,Segm *m1,Segm *m2)
{
register WORD *gr_pos;
register int cnt,alpha,da;
int x1,x2,x3,x4;
if (m1->deltax<0)
   { x1=m1->x+m1->deltax;x2=m1->x; }
else
   { x2=m1->x+m1->deltax;x1=m1->x; }
if (m2->deltax<0)
   { x3=m2->x+m2->deltax;x4=m2->x; }
else
   { x4=m2->x+m2->deltax;x3=m2->x; }
int ex1=x1>>FBASE,ex2=x2>>FBASE;
int ex3=x3>>FBASE,ex4=x4>>FBASE;
if (ex4<=0 || ex1>=gr_ancho ) return;
int rx = MA*(ex2-MTX)-MB*(y-MTY);
int ry = MB*(ex2-MTX)+MA*(y-MTY);
texture(rx,ry);
if (ex1>0) GR_SET(ex1,y) else GR_SET(0,y)
if (ex2>0) { // entrada anti
  if (ex1==ex2) { // punto solo
    gr_pixela(gr_pos,255-(BYTE)((x1+x2)>>1));gr_pos++;
  } else { // degrade
    alpha=0;//da=(255<<8)/(ex2-ex1);
    da=(ex2-ex1);
    if (da>0xff) da=tablainc[(da>>8)&0xff]>>8; else da=tablainc[da];

    if (ex1<0) { alpha+=da*(-ex1);ex1=0; }
    if (ex2>=gr_ancho) ex2=gr_ancho-1;
    cnt=ex2-ex1+1;
    while (cnt--) { gr_pixela(gr_pos,alpha>>8);gr_pos++;alpha+=da; }
    }
  }
if (ex3<=ex2) return;
if (ex3>0) { // lleno
    if (ex2<0) { rx+=MA*(-ex2);ry+=MB*(-ex2);ex2=0; }
    if (ex3>gr_ancho) ex3=gr_ancho;
    cnt=ex3-ex2-1;
    while (cnt--) {
        texture(rx,ry);
        gr_pixel(gr_pos);gr_pos++; 
        rx+=MA;
        ry+=MB;
        }
  }
if (ex4==ex3) { // punto solo
  gr_pixela(gr_pos,(BYTE)((x3+x4)>>1));
} else { // degrade
  alpha=255<<8;//da=(-255<<8)/(ex4-ex3);
  da=(ex4-ex3);
  if (da>0xff) da=-tablainc[(da>>8)&0xff]>>8; else da=-tablainc[da];

  if (ex3<0) { alpha+=da*(-ex3);ex3=0; }    
  if (ex4>gr_ancho) ex4=gr_ancho;
  cnt=ex4-ex3;
  while (cnt--) { gr_pixela(gr_pos,alpha>>8);gr_pos++;alpha+=da; }
  }
}

//----------------------------------------------------------
void addlin(Segm *ii) 
{
register int xr=ii->x;
Segm **cursor=(xquisc-1);
while (cursor>=xquis && (*cursor)->x>xr) {
      *(cursor+1)=*cursor;cursor--;
      }
if (cursor>=xquis && (*cursor)->x+(*cursor)->deltax > ii->x+ii->deltax) {
    *(cursor+1)=*cursor;cursor--; }    
*(cursor+1)=ii;
xquisc++;
}

void gr_drawPoli(void)
{
Segm **jj;
Segm *scopia=segmentos;
pact=actual;
segmentos[cntSegm].y=-1;
if (yMax>gr_alto) { yMax=gr_alto; }
for (;yMin<yMax;) {
    while (scopia->y==yMin) {
          *pact=scopia;pact++;scopia++;
          }
    xquisc=xquis;
    jj=actual;
    while (jj<pact) {
          addlin(*jj);
          jj++;
          }
    for (jj=xquis;jj+1<xquisc;jj+=2) {
/*
        gr_color1=0xff00;
        gr_hline(((*jj)->x+(*jj)->deltax)>>FBASE,yMin,((*(jj+1))->x+(*(jj+1))->deltax)>>FBASE);
        gr_color1=0xff;
        gr_hline((*jj)->x>>FBASE,yMin,(*(jj+1))->x>>FBASE);
*/
          fillpoly(yMin,*jj,*(jj+1));
          }
    jj=actual;
    yMin++;
    while (jj<pact) {
          if (yMin<(*jj)->yfin) {
             (*jj)->x+=(*jj)->deltax;
             jj++;
          } else {
            *jj=*(pact-1);
             pact--;
             }
          }
    }
yMin=gr_alto+1;
yMax=-1;
cntSegm=0;
}

//*****************************************************
/*

gr_segpoli *avanzaS(gr_segpoli *curSegs,int y)
{
gr_segpoli *s,*prev,*ant;
s=curSegs;prev=ant=0;
while(s) {
    if (y>=s->ymax) {// == para evitar superpuestos (**1)
        if (prev) prev->nextValid=s->nextValid;
		else curSegs=s->nextValid;
        s=s->nextValid;
    } else {
		s->x+=s->dx;
		if (prev!=0 && s->x<prev->x) { // se invirtio el orden
			if (ant==0) curSegs=s; else ant->nextValid=s;
			prev->nextValid=s->nextValid;
			s->nextValid=prev;ant=s;s=prev->nextValid;
		} else  { ant=prev;prev=s;s=s->nextValid; }// sigue igual
        }
    }
return curSegs;
}

gr_segpoli *nuevoS(gr_segpoli *curSegs,gr_segpoli *newSegs)
{
gr_segpoli *s,*se,*prev;
s=curSegs;prev=0;
for (se=newSegs;se;se=se->next) {
	if (curSegs==0) { curSegs=se;se->nextValid=0; } 
	else {
        for(;s;prev=s,s=s->nextValid) {
            if (s->x>se->x)	{
                if (prev) { se->nextValid=s;prev->nextValid=se; } 
				else { se->nextValid=curSegs;curSegs=se; }
                break;
                }
            }
		if (s==0) { prev->nextValid=se;se->nextValid=0; }// agregar al final
        }
    s=se;
    }
return curSegs;
}

// Poligonos con antialiasing
inline void Flinea(int y,int x1,int x2,int x3,int x4)
{
int ex1=x1>>SEGFRAC,ex2=x2>>SEGFRAC;
int ex3=x3>>SEGFRAC,ex4=x4>>SEGFRAC;
register WORD *gr_pos;
if (ex2>=0) {
	if (ex1<ex2) gr_hlined(ex1,y,ex2,0,255);
	else { GR_SET(ex1,y);gr_pixela(gr_pos,255-(BYTE)((x1+x2)>>1));
		if (ex2==ex4) return;}
	}
ex2++;
if (ex2<ex3) gr_hline(ex2,y,ex3-1);
if (ex3<gr_ancho) {
	if (ex3<ex4) gr_hlined(ex3,y,ex4,255,0);
	else { GR_SET(ex3,y);gr_pixela(gr_pos,(BYTE)((x3+x4)>>1)); }
	}
}

//**************************************************
//***** DIBUJO DE POLIGONO
//**************************************************
void gr_drawPoli(void)
{
int x1,x3,y;
int x2,x4;
int auxl=gr_ancho<<SEGFRAC;
gr_segpoli *curSegs,*s;
if (gr_limymax==-1) return;
curSegs=NULL;
gr_segpoli **linesp=&gr_lines[gr_limymin];
for(y=gr_limymin;y<gr_limymax;y++) {
    curSegs=avanzaS(curSegs,y);
    curSegs=nuevoS(curSegs,*linesp);
	s=curSegs;// salto anteriores a la pantalla
	while (s && s->nextValid && s->nextValid->x<0)
		s=s->nextValid->nextValid;
	while (s && s->nextValid && s->x<auxl) {// hasta que este afuera
		x1=s->x;x2=s->x+s->dx;if (s->dx<0) swap(x1,x2);
		s=s->nextValid;
		x3=s->x;x4=s->x+s->dx;if (s->dx<0) swap(x3,x4);
		Flinea(y,x1,x2,x3,x4);

/// sin antialiasing (mas rapido)
//		x1=(s->x>>SEGFRAC);s=s->nextValid;
//		x3=(s->x>>SEGFRAC);
//		if (x1<0) x1=0;
//		if (x3>=gr_ancho) x3=gr_ancho-1;
//		gr_set(x1,y);gr_hline(x3-x1);
// 
		s=s->nextValid;
		}
	*linesp=NULL;linesp++;
    }
gr_limymax=-1;gr_limymin=gr_alto+1;gr_linact=gr_seg;
}

/*
void gr_drawLines(WORD gr)
{
int x,dx,x1,x2,x3,x4,t;
gr_segpoli *curSegs,*s;
if (gr_limymax==-1) return;
curSegs=NULL;
for(unsigned short y=gr_limymin;y<gr_limymax;y++) {
    curSegs=avanzaS(curSegs,y);
    curSegs=nuevoS(curSegs,gr_lines[y]);
	for(s=curSegs;s;s=s->nextValid) {
		if (s->x<0) continue; // anteriores a la pantalla
	    if ((s->x>>SEGFRAC)>=gr_ancho) break; //siguientes de la pantalla
		x=s->x;dx=s->x+s->dx;
		if (s->dx<0) {t=x;x=dx;dx=t;}
		x1=x-(1<<SEGFRAC);x2=dx-(1<<SEGFRAC);
		x3=x+(1<<SEGFRAC);x4=dx+(1<<SEGFRAC);
/*
	s=s->nextValid;
	x3=s->x;x4=s->x+s->dx;
	if (s->dx<0) {t=x3;x3=x4;x4=t;}	
*//*
		Flinea(y,x1,x2,x3,x4);
	    }
    }
memset(&gr_lines[gr_limymin],0,(gr_limymax-gr_limymin+1)*sizeof(gr_segpoli *));
gr_limymax=-1;gr_limymin=gr_alto+1;gr_linact=gr_seg;
}
*/


//----- alfabeto bitmap
const unsigned char fontv12[] = {
2,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//0 
6,0x00,0x00,0x00,0x82,0x44,0x28,0x10,0x28,0x44,0x82,0x00,0x00,//1
7,0x00,0x00,0x10,0x10,0x38,0x38,0x7c,0x7c,0xfe,0xfe,0x00,0x00,//2
7,0x00,0x00,0xfe,0xfe,0x7c,0x7c,0x38,0x38,0x10,0x10,0x00,0x00,//3
2,0x00,0x00,0x60,0x60,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x00,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x00,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x00,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x00,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x20,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
2,0x00,0x00,0x20,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
4,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//32 espacio
1,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x40,0x00,0x00,//!
4,0x00,0x48,0x48,0x48,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//34
6,0x00,0x24,0x24,0x7E,0x24,0x24,0x24,0x7E,0x24,0x24,0x00,0x00,//35
5,0x00,0x10,0x38,0x54,0x50,0x30,0x18,0x14,0x54,0x38,0x10,0x00,//36
7,0x00,0x30,0x49,0x32,0x04,0x08,0x10,0x26,0x49,0x06,0x00,0x00,
5,0x00,0x20,0x50,0x50,0x20,0x20,0x54,0x48,0x48,0x34,0x00,0x00,
1,0x00,0x40,0x40,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,//'
2,0x00,0x20,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x20,
2,0x00,0x40,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x40,
3,0x00,0x00,0x50,0x20,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x10,0x10,0x7C,0x10,0x10,0x00,0x00,0x00,
2,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x40,0x00,
2,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x00,0x00,0x00,//-
2,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,
4,0x00,0x08,0x08,0x08,0x10,0x10,0x20,0x20,0x40,0x40,0x00,0x00,
5,0x00,0x38,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x38,0x00,0x00,
3,0x00,0x10,0x70,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x00,0x00,
5,0x00,0x38,0x44,0x04,0x04,0x08,0x10,0x20,0x40,0x7C,0x00,0x00,
5,0x00,0x38,0x44,0x04,0x04,0x18,0x04,0x04,0x44,0x38,0x00,0x00,
5,0x00,0x08,0x18,0x18,0x28,0x28,0x48,0x7C,0x08,0x08,0x00,0x00,
5,0x00,0x7C,0x40,0x40,0x78,0x44,0x04,0x04,0x44,0x38,0x00,0x00,
5,0x00,0x38,0x44,0x40,0x40,0x78,0x44,0x44,0x44,0x38,0x00,0x00,
5,0x00,0x7C,0x04,0x08,0x08,0x10,0x10,0x20,0x20,0x20,0x00,0x00,
5,0x00,0x38,0x44,0x44,0x44,0x38,0x44,0x44,0x44,0x38,0x00,0x00,
5,0x00,0x38,0x44,0x44,0x44,0x3C,0x04,0x04,0x44,0x38,0x00,0x00,
2,0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x40,0x00,0x00,
2,0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x00,0x20,0x40,0x00,
4,0x00,0x00,0x00,0x08,0x10,0x20,0x40,0x20,0x10,0x08,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x00,0x7C,0x00,0x7C,0x00,0x00,0x00,0x00,
4,0x00,0x00,0x00,0x40,0x20,0x10,0x08,0x10,0x20,0x40,0x00,0x00,
5,0x00,0x38,0x44,0x04,0x04,0x08,0x10,0x10,0x00,0x10,0x00,0x00,
5,0x00,0x00,0x38,0x44,0x44,0x5c,0x5c,0x58,0x40,0x40,0x38,0x00,// 64
6,0x00,0x10,0x10,0x28,0x28,0x44,0x44,0x7C,0x82,0x82,0x00,0x00,//A
5,0x00,0x78,0x44,0x44,0x44,0x78,0x44,0x44,0x44,0x78,0x00,0x00,
6,0x00,0x3C,0x42,0x40,0x40,0x40,0x40,0x40,0x42,0x3C,0x00,0x00,
6,0x00,0x78,0x44,0x42,0x42,0x42,0x42,0x42,0x44,0x78,0x00,0x00,
5,0x00,0x7C,0x40,0x40,0x40,0x78,0x40,0x40,0x40,0x7C,0x00,0x00,
5,0x00,0x7C,0x40,0x40,0x40,0x78,0x40,0x40,0x40,0x40,0x00,0x00,
6,0x00,0x3C,0x42,0x40,0x40,0x4E,0x42,0x42,0x46,0x3A,0x00,0x00,//G
6,0x00,0x42,0x42,0x42,0x42,0x7E,0x42,0x42,0x42,0x42,0x00,0x00,
2,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x00,
3,0x00,0x10,0x10,0x10,0x10,0x10,0x10,0x90,0x90,0x60,0x00,0x00,
6,0x00,0x44,0x48,0x50,0x60,0x60,0x50,0x48,0x44,0x42,0x00,0x00,
5,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x7C,0x00,0x00,
7,0x00,0x41,0x41,0x63,0x63,0x55,0x55,0x49,0x49,0x41,0x00,0x00,
6,0x00,0x42,0x62,0x62,0x52,0x52,0x4A,0x46,0x46,0x42,0x00,0x00,
6,0x00,0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x00,0x7C,0x42,0x42,0x42,0x7C,0x40,0x40,0x40,0x40,0x00,0x00,
6,0x00,0x3C,0x42,0x42,0x42,0x42,0x42,0x4A,0x46,0x3C,0x02,0x00,
6,0x00,0x7C,0x42,0x42,0x42,0x7C,0x42,0x42,0x42,0x42,0x00,0x00,
5,0x00,0x38,0x44,0x40,0x40,0x38,0x04,0x04,0x44,0x38,0x00,0x00,
5,0x00,0x7C,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x00,0x00,
6,0x00,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x00,0x82,0x82,0x44,0x44,0x44,0x28,0x28,0x10,0x10,0x00,0x00,
7,0x00,0x41,0x41,0x41,0x41,0x22,0x2A,0x2A,0x2A,0x14,0x00,0x00,//87 W
7,0x00,0x41,0x41,0x22,0x14,0x08,0x14,0x22,0x41,0x41,0x00,0x00,//88 X
6,0x00,0x82,0x82,0x44,0x28,0x10,0x10,0x10,0x10,0x10,0x00,0x00,
6,0x00,0xFE,0x02,0x04,0x08,0x10,0x20,0x40,0x80,0xFE,0x00,0x00,
2,0x00,0x60,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x60,
4,0x00,0x40,0x40,0x40,0x20,0x20,0x10,0x10,0x08,0x08,0x00,0x00,
2,0x00,0x60,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x60,
5,0x10,0x28,0x44,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,
2,0x00,0x40,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x38,0x04,0x3C,0x44,0x44,0x3C,0x00,0x00,
5,0x00,0x40,0x40,0x40,0x78,0x44,0x44,0x44,0x44,0x78,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x38,0x44,0x40,0x40,0x44,0x38,0x00,0x00,
5,0x00,0x04,0x04,0x04,0x3C,0x44,0x44,0x44,0x44,0x3C,0x00,0x00,//100 d
5,0x00,0x00,0x00,0x00,0x38,0x44,0x7C,0x40,0x44,0x38,0x00,0x00,//101 e
2,0x00,0x20,0x40,0x40,0x60,0x40,0x40,0x40,0x40,0x40,0x00,0x00,//102
5,0x00,0x00,0x00,0x00,0x3C,0x44,0x44,0x44,0x44,0x3C,0x04,0x78,//103
5,0x00,0x40,0x40,0x40,0x58,0x64,0x44,0x44,0x44,0x44,0x00,0x00,//104 h
1,0x00,0x40,0x00,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x00,//105 i
2,0x00,0x40,0x00,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,//106 j
5,0x00,0x40,0x40,0x40,0x48,0x50,0x60,0x50,0x48,0x44,0x00,0x00,//107 k
1,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x00,//108
7,0x00,0x00,0x00,0x00,0x76,0x49,0x49,0x49,0x49,0x49,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x58,0x64,0x44,0x44,0x44,0x44,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x38,0x44,0x44,0x44,0x44,0x38,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x78,0x44,0x44,0x44,0x44,0x78,0x40,0x40,
5,0x00,0x00,0x00,0x00,0x3C,0x44,0x44,0x44,0x44,0x3C,0x04,0x04,
2,0x00,0x00,0x00,0x00,0x60,0x40,0x40,0x40,0x40,0x40,0x00,0x00,
4,0x00,0x00,0x00,0x00,0x30,0x48,0x20,0x10,0x48,0x30,0x00,0x00,
2,0x00,0x00,0x40,0x40,0x60,0x40,0x40,0x40,0x40,0x20,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x44,0x44,0x44,0x44,0x4C,0x34,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x44,0x44,0x28,0x28,0x10,0x10,0x00,0x00,
7,0x00,0x00,0x00,0x00,0x49,0x49,0x55,0x55,0x22,0x22,0x00,0x00,
4,0x00,0x00,0x00,0x00,0x48,0x48,0x30,0x30,0x48,0x48,0x00,0x00,
4,0x00,0x00,0x00,0x00,0x48,0x48,0x48,0x48,0x30,0x20,0x20,0xC0,
4,0x00,0x00,0x00,0x00,0x78,0x08,0x10,0x20,0x40,0x78,0x00,0x00,
3,0x10,0x20,0x20,0x20,0x20,0x40,0x20,0x20,0x20,0x20,0x10,0x00,
2,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,
3,0x40,0x20,0x20,0x20,0x20,0x10,0x20,0x20,0x20,0x20,0x40,0x00,// 125 }
6,0x00,0x00,0x32,0x4C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,// 126 ~
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,// 127 ¦
5,0x00,0x38,0x44,0x44,0xF0,0x40,0xE0,0x44,0x44,0x38,0x00,0x00,// 128 Ç
7,0x00,0x00,0x10,0x10,0x38,0x38,0x7c,0x7c,0xfe,0xfe,0x00,0x00,//
7,0x00,0x00,0xfe,0xfe,0x7c,0x7c,0x38,0x38,0x10,0x10,0x00,0x00,//
2,0x00,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x00,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x00,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x00,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x00,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x20,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
2,0x00,0x00,0x20,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x60,0x00,
2,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
2,0x00,0x00,0x00,0x40,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,
5,0x00,0x00,0x00,0x08,0x38,0x44,0x40,0x40,0x44,0x38,0x20,0x00,
5,0x00,0x30,0x48,0x40,0x20,0x70,0x20,0x40,0x40,0x7C,0x00,0x00,
5,0x00,0x44,0x38,0x44,0x44,0x44,0x38,0x44,0x00,0x00,0x00,0x00,
5,0x00,0x44,0x44,0x44,0x28,0x7C,0x10,0x7C,0x10,0x10,0x00,0x00,
2,0x00,0x40,0x40,0x40,0x40,0x40,0x00,0x40,0x40,0x40,0x40,0x40,
5,0x00,0x38,0x44,0x20,0x50,0x48,0x24,0x14,0x08,0x44,0x38,0x00,
2,0x00,0x00,0xA0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
8,0x00,0x1E,0x21,0x4C,0x50,0x4C,0x21,0x1E,0x00,0x00,0x00,0x00,
3,0x00,0x60,0x30,0x50,0x70,0x00,0x70,0x00,0x00,0x00,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x00,0x14,0x28,0x50,0x28,0x14,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x00,0x00,0x7C,0x04,0x00,0x00,0x00,0x00,
2,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x00,0x00,0x00,0x00,
7,0x00,0x1C,0x22,0x5D,0x59,0x55,0x22,0x1C,0x00,0x00,0x00,0x00,
5,0xFC,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
3,0x00,0x20,0x50,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
5,0x00,0x00,0x00,0x10,0x10,0x7C,0x10,0x10,0x00,0x7C,0x00,0x00,
2,0x00,0xC0,0x20,0x40,0x80,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,
2,0x00,0xC0,0x20,0x40,0x20,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,
2,0x00,0x20,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x48,0x48,0x48,0x48,0x48,0x74,0x40,0x40,
5,0x00,0x3C,0x7C,0x7C,0x7C,0x3C,0x14,0x14,0x14,0x14,0x14,0x00,
2,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x00,0x00,
2,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x60,
2,0x00,0x20,0x60,0x20,0x20,0x20,0x00,0x00,0x00,0x00,0x00,0x00,
3,0x00,0x70,0x50,0x50,0x70,0x00,0x70,0x00,0x00,0x00,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x00,0x50,0x28,0x14,0x28,0x50,0x00,0x00,
7,0x00,0x20,0x61,0x22,0x24,0x29,0x13,0x25,0x47,0x01,0x00,0x00,
7,0x00,0x20,0x61,0x22,0x24,0x2E,0x11,0x22,0x44,0x07,0x00,0x00,
7,0x00,0x60,0x11,0x22,0x14,0x69,0x13,0x25,0x47,0x01,0x00,0x00,
5,0x00,0x00,0x00,0x10,0x00,0x10,0x10,0x20,0x40,0x40,0x44,0x38,
6,0x10,0x10,0x10,0x28,0x28,0x44,0x44,0x7C,0x82,0x82,0x00,0x00,
6,0x10,0x10,0x10,0x28,0x28,0x44,0x44,0x7C,0x82,0x82,0x00,0x00,
6,0x28,0x00,0x10,0x28,0x28,0x44,0x44,0x7C,0x82,0x82,0x00,0x00,
6,0x58,0x10,0x10,0x28,0x28,0x44,0x44,0x7C,0x82,0x82,0x00,0x00,
6,0x00,0x10,0x10,0x28,0x28,0x44,0x44,0x7C,0x82,0x82,0x00,0x00,
6,0x28,0x10,0x10,0x28,0x28,0x44,0x44,0x7C,0x82,0x82,0x00,0x00,
8,0x00,0x1F,0x18,0x28,0x28,0x4F,0x78,0x48,0x88,0x8F,0x00,0x00,
6,0x00,0x3C,0x42,0x40,0x40,0x40,0x40,0x40,0x42,0x3C,0x08,0x18,
5,0x10,0x7C,0x40,0x40,0x40,0x78,0x40,0x40,0x40,0x7C,0x00,0x00,
5,0x10,0x7C,0x40,0x40,0x40,0x78,0x40,0x40,0x40,0x7C,0x00,0x00,
5,0x28,0x7C,0x40,0x40,0x40,0x78,0x40,0x40,0x40,0x7C,0x00,0x00,
5,0x00,0x7C,0x40,0x40,0x40,0x78,0x40,0x40,0x40,0x7C,0x00,0x00,
2,0x40,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x00,
2,0x40,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x00,
2,0xA0,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x00,
2,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x00,
6,0x00,0x78,0x44,0x42,0x42,0xF2,0x42,0x42,0x44,0x78,0x00,0x00,
6,0x4C,0x42,0x62,0x62,0x52,0x52,0x4A,0x46,0x46,0x42,0x00,0x00,
6,0x08,0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x10,0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x24,0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x4C,0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x00,0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x44,0x28,0x10,0x28,0x44,0x00,0x00,0x00,
6,0x00,0x3E,0x46,0x4A,0x4A,0x52,0x52,0x62,0x62,0x7C,0x00,0x00,
6,0x08,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x10,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x24,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x00,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00,
6,0x10,0x82,0x82,0x44,0x28,0x10,0x10,0x10,0x10,0x10,0x00,0x00,
6,0x00,0x40,0x40,0x7C,0x42,0x42,0x42,0x7C,0x40,0x40,0x00,0x00,
5,0x00,0x30,0x48,0x48,0x48,0x58,0x44,0x44,0x44,0x58,0x00,0x00,
5,0x00,0x20,0x10,0x00,0x38,0x04,0x3C,0x44,0x44,0x3C,0x00,0x00,
5,0x00,0x08,0x10,0x00,0x38,0x04,0x3C,0x44,0x44,0x3C,0x00,0x00,
5,0x00,0x10,0x28,0x00,0x38,0x04,0x3C,0x44,0x44,0x3C,0x00,0x00,
5,0x00,0x34,0x58,0x00,0x38,0x04,0x3C,0x44,0x44,0x3C,0x00,0x00,
5,0x00,0x24,0x00,0x00,0x38,0x04,0x3C,0x44,0x44,0x3C,0x00,0x00,
5,0x10,0x28,0x10,0x00,0x38,0x04,0x3C,0x44,0x44,0x3C,0x00,0x00,
9,0x00,0x00,0x00,0x00,0x3B,0x04,0x3F,0x44,0x44,0x3B,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x38,0x44,0x40,0x40,0x44,0x38,0x10,0x30,
5,0x00,0x20,0x10,0x00,0x38,0x44,0x7C,0x40,0x44,0x38,0x00,0x00,
5,0x00,0x08,0x10,0x00,0x38,0x44,0x7C,0x40,0x44,0x38,0x00,0x00,
5,0x00,0x10,0x28,0x00,0x38,0x44,0x7C,0x40,0x44,0x38,0x00,0x00,
5,0x00,0x44,0x00,0x00,0x38,0x44,0x7C,0x40,0x44,0x38,0x00,0x00,
2,0x00,0x80,0x40,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x00,0x00,
3,0x00,0x10,0x20,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0x00,
3,0x00,0x20,0x50,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0x00,
3,0x00,0x50,0x00,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0x00,
5,0x00,0x28,0x10,0x28,0x08,0x3C,0x44,0x44,0x44,0x38,0x00,0x00,
5,0x00,0x34,0x58,0x00,0x58,0x64,0x44,0x44,0x44,0x44,0x00,0x00,
5,0x00,0x20,0x10,0x00,0x38,0x44,0x44,0x44,0x44,0x38,0x00,0x00,
5,0x00,0x08,0x10,0x00,0x38,0x44,0x44,0x44,0x44,0x38,0x00,0x00,
5,0x00,0x10,0x28,0x00,0x38,0x44,0x44,0x44,0x44,0x38,0x00,0x00,
5,0x00,0x34,0x58,0x00,0x38,0x44,0x44,0x44,0x44,0x38,0x00,0x00,
5,0x00,0x44,0x00,0x00,0x38,0x44,0x44,0x44,0x44,0x38,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x10,0x00,0x7C,0x00,0x10,0x00,0x00,0x00,
5,0x00,0x00,0x00,0x00,0x3C,0x4C,0x54,0x54,0x64,0x78,0x00,0x00,
5,0x00,0x20,0x10,0x00,0x44,0x44,0x44,0x44,0x4C,0x34,0x00,0x00,
5,0x00,0x08,0x10,0x00,0x44,0x44,0x44,0x44,0x4C,0x34,0x00,0x00,
5,0x00,0x10,0x28,0x00,0x44,0x44,0x44,0x44,0x4C,0x34,0x00,0x00,
5,0x00,0x44,0x00,0x00,0x44,0x44,0x44,0x44,0x4C,0x34,0x00,0x00,
4,0x00,0x10,0x20,0x00,0x48,0x48,0x48,0x48,0x30,0x20,0x20,0xC0,
5,0x00,0x40,0x40,0x40,0x78,0x44,0x44,0x44,0x44,0x78,0x40,0x40,
4,0x00,0x48,0x00,0x00,0x48,0x48,0x48,0x48,0x30,0x20,0x20,0xC0};

const BYTE bit[]={0x80,0x40,0x20,0x10,0x8,0x4,0x2,0x1};

char gr_char(int x,int y,BYTE c)
{
const BYTE *car=&fontv12[c*13];
register int i,j,cnt=(*car)+1;
car++;
for (i=0;i<12;i++,car++,y++)
  for (j=0;j<cnt;j++)
    if (*car&bit[j]) gr_setpixel(x+j,y);
return cnt;
}

char gr_chari(int x,int y,BYTE c)
{
const BYTE *car=&fontv12[c*13];
register int i,j,cnt=(*car)+1;
car++;
for (i=0;i<12;i++,car++,y++)
  for (j=0;j<cnt;j++)
    if (!(*car&bit[j])) gr_setpixel(x+j,y);
return cnt;
}

char gr_chard(int x,int y,BYTE c)
{
const BYTE *car=&fontv12[c*13];
register int i,j,cnt=(*car)+1;
car++;
for (i=0;i<12;i++,car++,y++)
  for (j=0;j<cnt;j++)
	  if (!(*car&bit[j])) { gr_setpixel(x+2*j,y);gr_setpixel(x+2*j+1,y);}
return cnt*2;
}

char gr_charc(int x,int y,BYTE c)
{
const BYTE *car=&fontv12[c*13];
char cnt=(*car)+1;
return gr_char(x-(cnt>>1),y-6,c);
}

void gr_textsize(char *t,int *x,int *y)
{
char cnt;
*x=0;*y=12;
for (;*t!=0;t++) {
	cnt=fontv12[((BYTE)*t)*13]+1;	
	*x+=cnt;
	}
}

void gr_text(int x,int y,char *t)
{
char cnt;
for (;*t!=0;t++) {
	cnt=gr_char(x,y,(BYTE)*t);
	x+=cnt;
	}
}

void gr_textc(int x,int y,char *t)
{
int xs,ys;
gr_textsize(t,&xs,&ys);
gr_text(x-(xs>>1)+1,y-5,t);
}

#define MAX(a,b) ((a>b)?a:b)
#define MIN(a,b) ((a<b)?a:b)

#define HLSMAX 240 // H,L, and S vary over 0-HLSMAX
#define RGBMAX 255 //;			// R,G, and B vary over 0-RGBMAX
#define UNDEFINED (HLSMAX*2/3)

void RGB_to_HSL(int r,int g,int b,int *h,int *s,int *l)
{
int cMax, cMin;
int Rdelta,Gdelta,Bdelta;

cMax=MAX(r,MAX(g,b));
cMin=MIN(r,MAX(g,b));
*l=(((cMax+cMin)*HLSMAX)+RGBMAX)/(2*RGBMAX);
if (cMax==cMin) //r=g=b --> achromatic case
	{ *s=0;*h=UNDEFINED; }
else
	{
	if (*l<=(HLSMAX/2))
		*s=(((cMax-cMin)*HLSMAX)+((cMax+cMin)/2))/(cMax+cMin);
	else
		*s=(((cMax-cMin)*HLSMAX)+((2*RGBMAX-cMax-cMin)/2))/(2*RGBMAX-cMax-cMin);
    Rdelta=(((cMax-r)*(HLSMAX/6))+((cMax-cMin)/2))/(cMax-cMin);
    Gdelta=(((cMax-g)*(HLSMAX/6))+((cMax-cMin)/2))/(cMax-cMin);
    Bdelta=(((cMax-b)*(HLSMAX/6))+((cMax-cMin)/2))/(cMax-cMin);
    if (r==cMax)		*h=Bdelta-Gdelta;
    else if (g==cMax)	*h=(HLSMAX/3)+Rdelta-Bdelta;
    else				*h=((2*HLSMAX)/3)+Gdelta-Rdelta;
    *h=*h%HLSMAX;
    if (*h<0) *h+=HLSMAX;
	}
}

int HueToRGB(int n1,int n2,int hue)
{
hue=hue%HLSMAX;
//hue=hue&0xff;
if (hue<0) hue+=HLSMAX;
if (hue<(HLSMAX/6))
	return (n1+(((n2-n1)*hue+(HLSMAX/12))/(HLSMAX/6)));
else if (hue<(HLSMAX/2))
	return n2;
else if (hue<((HLSMAX*2)/3))
    return (n1+(((n2-n1)*(((HLSMAX*2)/3)-hue)+(HLSMAX/12))/(HLSMAX/6)));
else
	return n1;
};

void HSL_to_RGB(int h,int s,int l,int *r,int *g,int *b)
{
int m1,m2;
if (s==0)
	{ *b=*g=*r=(l*RGBMAX)/HLSMAX; }
else {
	if (l<=(HLSMAX/2))
		m2=(l*(HLSMAX+s)+(HLSMAX/2))/HLSMAX;
	else
		m2=l+s-((l*s)+(HLSMAX/2))/HLSMAX;
	m1=2*l-m2;
	*r=(HueToRGB(m1,m2,h+(HLSMAX/3))*RGBMAX+(HLSMAX/2))/HLSMAX;
    *g=(HueToRGB(m1,m2,h)           *RGBMAX+(HLSMAX/2))/HLSMAX;
    *b=(HueToRGB(m1,m2,h-(HLSMAX/3))*RGBMAX+(HLSMAX/2))/HLSMAX;
	}
}