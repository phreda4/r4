| CODEdo (ide)
| PHREDA 2013
|----------------------
^r4/lib/gui.txt
^r4/lib/btn.txt
^r4/lib/input.txt

^r4/lib/rfont.txt
^r4/lib/ricons.txt
^inc/ric/fontawesomewebfont.ric
^inc/rft/dejavusans.rft

^r4/dev/ide/tokenr4.txt

#sizepad

#error
#ypad

#tokin )( 2048
#tokin> 'tokin
#pad )( 2048
#pad> 'pad


#hist )( $ffff
#hist> 'hist

#strerror
"Ok"
"Palabra no definida"
"Palabra sin direccion"
"Desborde de Pila"
"Escases de Pila"
"Pila Incompatible"
"Falta ;"
"Bloque mal cerrado"
"No existe Libreria"
0

#strerrorEN
"Ok"
"Undefined Word"
"No Word Adress"
"Stack Overflow"
"Stack Underflow"
"Stack not match"
"Need ;"
"Bad Structure"
"Library not exist"
0

:resetpad
	sh 2/ |sizepad -
	'ypad ! ;

#newline ( 13 0 )

:morepad
|	sizepad neg 'ypad +!
	'pad 'newline strcat
	refreshfoco
	;

:errorpad
	-? ( drop morepad ; ) | negativo
	'strerror swap ( 1? )( swap >>0 swap 1- ) drop
	'error !
	;

#tokenpad

:ejecuta
	tokencod> 'tokenpad !

	'pad count swap
	hist> strcat
	'hist> +!

	'pad str2token
	1? ( errorpad ; ) drop


	tokenpad exectoken

	tokenpad 'tokencod> !

	resetpad
	'pad stackdstr
	refreshfoco ;

:showglass
	ypad sw * 2 <<
	framev +
	sw sh ypad - *
	( 1? )( 1- swap dup @ 2/
		$7f7f7f and
		swap !+ swap )
	2drop
	;

|----- MEMO COLOR

:showpad
	dejavusans sizepad rfont!
	showglass
	4 ypad atxy
	| imprime tira de tokens
	azul
	'tokin ( tokin> <? )(
		@+ " %h" print
		) drop

	blanco
|	'ejecuta 'pad 2048 inword
	'pad 2048 inword
	;

:msgerror
	error 0? ( drop ; )
	amarillo
	print ;

:showhistoria
	blanco
	'hist print
	;

:main
	4
	show clrscr
		fonti
		verde dup "r%d: " print msgerror cr
		amarillo dumptok cr
		verde dumpdic cr

		showhistoria
		showpad

|		24 sh 24 - pos 48 qdim
|		'exit rojo btne negro 'i.off drawric
|		gc>> exit verde btne blanco 'i.play drawric

		[ 4 'sizepad +! resetpad ; ] <f1>
		[ -4 'sizepad +! resetpad ; ] <f2>

		cminiflecha
		'exit >esc< ;

:m
	mark
	80 'sizepad !
	resetpad
	0 paper
	;

: m main ;