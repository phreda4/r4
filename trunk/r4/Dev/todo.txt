^r4/lib/gui.txt
^r4/lib/graf.txt
^r4/lib/fonti.txt

#objs )( 10000
#pad 8

:s!+ swap !+ ;

:dummy.data
	3 'objs !+
	200 s!+ 100 s!+ 3 s!+ "Note 1" swap strcpyl
	150 s!+ 220 s!+ 7 s!+ "Note 2" swap strcpyl
	250 s!+ 420 s!+ 18 s!+ "Note 3" swap strcpy ;

:draw.line 0 0 op xymouse line ;

:load.objs | ( -- )
	   'objs "mem/todo.mem" load drop ;

:save.objs | ( -- )
	   dummy.data
	   'objs 10000 "mem/todo.mem" save ;

:rot- | ( a b c -- c a b )
      rot rot ;

:adjust.pad | ( -- pad.val )
	cch 4 / 'pad ! ;

:add.padding | ( h w x y -- hh ww xx yy )
	     adjust.pad
	     pad - swap pad - swap
	     2swap
	     pad 2* + swap pad 2* + swap
	     2swap ;

:rect | ancho alto x y --
        2swap >r >r
        2dup op over r> + over 2dup line r + line
        2dup r> + line line ;

:4dup pick3 pick3 pick3 pick3 ;

:draw.obj | ( x y txt -- )
	negro sizeprint >r
	rot- 2dup r> cch 2swap add.padding
	4dup
	$dddddd ink vfill
	negro rect
	atxy negro print ;

:debug dup rojo "%d" print ;

:mouse.pos 
	   negro xymouse swap "[ %d , %d ]" print ;

:n.objs 'objs @ ;

:draw.objs
	200 100 "Example Note 1" draw.obj
	150 220 "Example Note 2" draw.obj ;

:edit
    $cccccc paper
    fonti
    show clrscr
    	debug cr
	mouse.pos
	draw.objs
	cflecha
	'exit >esc< ;

: load.objs 33 edit save.objs ;
