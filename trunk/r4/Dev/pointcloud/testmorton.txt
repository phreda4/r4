^r4/lib/gui.txt

|------ MORTON COMANDER  x y z . 10 bits
:p1x2 | x -- v
 	$3ff and
	dup 16 << xor $ff0000ff and
	dup 8 << xor  $0300f00f and
	dup 4 << xor  $030c30c3 and
	dup 2 << xor  $09249249 and ;

:morton3d | x y z -- Z
	p1x2 2* swap p1x2 or 2* swap p1x2 or ;

:c1x2 | x - v
	$09249249 and
	dup 2 >> xor $030c30c3 and
	dup 4 >> xor $0300f00f and
	dup 8 >> xor $ff0000ff and
	dup 16 >> xor $3ff and ;

:invmorton3d | Z -- x y z
 	dup c1x2 swap 2/ dup c1x2 swap 2/ c1x2 ;

:testprog
	0 ( 5 <? )(
		0 ( 5 <? )(
			0 ( 5 <? )(
				pick2 pick2 pick2 swap rot "%d %d %d = " print
				pick2 pick2 pick2 swap rot morton3d "%h    " print cr
				allowchome
				1+ ) drop
			1+ ) drop
		1+ ) drop ;

:testproy
	30 40 1
	( 40 <? )(
		pick2 pick2 pick2 "%d %d %d " print
		pick2 pick2 pick2 morton3d " %h " print
		pick2 over / pick2 pick2 / "%d %d" print cr
		1+ ) 3drop
	;
:main
	show clrscr |chome!
		testproy
		'exit >esc<
		;

: mark main ;