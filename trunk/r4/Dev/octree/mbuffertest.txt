| mask buffer test
| PHREDA 2015
|-------------------------
^r4/lib/gui.txt
^r4/lib/mbuffer.txt
^r4/lib/trace.txt

|-------------test mask
:maskb.draw
	maskb >r
	0 0 setxy
	sh ( 1? )( 1-
		32 ( 1? )( 1-
			r@+ 32 ( 1? )( 1- swap
				1 and? ( $ffffff )( 0 ) px!+
				2/
				swap ) 2drop
			) drop
		) drop
	rdrop ;

:dbox | x1 y1 x2 y2 --
	2over op
	pick3 over line
	2dup line
	over pick3 line
	2drop line ;

:livetest
	40 40 over 48 + over 48 +
	maskb.rget 1? ( rojo )( verde ) drop
	40 40 over 48 + over 48 + dbox
	100 40 maskb.get 1? ( rojo )( verde ) drop
	100 40 2dup op line
	;

:boxytest | x y color --
	ink
	xymouse
	2swap pick2 +
	swap pick3 + swap
	2over 2over dbox maskb.rset ;

#test $f0f0f0a1
:main
	maskb.ini
	maskb.clear
	cls
	33
	show clrscr
		dup "%d " print cr

		livetest

		rand xymouse maskpxy

		[ rojo 20 ( 40 <? )( 34 over 74 maskfpx 1+ ) drop ; ] <f1>
		[ verde 30 ( 50 <? )( 40 over 184 maskfpx 1+ ) drop ; ] <f2>
		[ amarillo 50 ( 90 <? )( dup 10 200 maskfpy 1+ ) drop ; ] <f3>
		[ azul 35 34 56 48 maskfpxy ; ] <f4>
		[ violeta 40 40 190 120 maskfpxy ; ] <f5>
		'exit >esc<
		;

: mark main ;

