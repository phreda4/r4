| qbuffer
| PHREDA 2014
|-----------------------------
^r4/lib/morton.txt

#buffer )( $2ffff	| hasta  1024x1024
#buffer> 'buffer
#quaniv 1 1	2 8	32 128 512 2048 8192 32768
#quaniv> 'quaniv

::quaini
	'quaniv 'quaniv> !
	'buffer 'buffer> !
	'buffer >r
	$2aac | para 512*512
|	$aaac | para 1024*1024
	( 1? )( 1- 0 r!+ ) drop rdrop ;

::qua! | morton --
	dup 5 >> 2 << buffer> + swap
	$1f and place over @ or swap ! ;

|************
:placeq
	2 >> $f swap << ;

:quacheck! | morton --
	dup 5 >> 2 << buffer> + swap
	$1f and place over @ or

	swap ! ;
|************

::qua@ | morton -- 0/any
	dup 5 >> 2 << buffer> + @
	swap $1f and place and ;


::quapush
	quaniv> @+ 2 << 'buffer> +! 'quaniv> ! ;

::quapop
	quaniv> 4 - dup 'quaniv> !
	2 << neg 'buffer> +! ;

