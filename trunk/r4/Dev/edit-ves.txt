| VESPRITE editor
| PREDA 2013
|-------------------------------------
^r4/lib/gui.txt
^r4/lib/btn.txt
^r4/lib/dlgcolora.txt

^r4/lib/vesprite.txt
^r4/lib/rfont.txt
^r4/lib/ricons.txt

^r4/lib/trace.txt

^inc/ric/fontawesomewebfont.ric
^inc/rft/robotoregular.rft

|-----------------
#color $00

#dibujoed )( $ffff
#dibujoed> 'dibujoed

#indpol )( $fff
#indpol> 'indpol

#trazo )( $fff
#trazo> 'trazo

:-trazo
	'trazo 0 over ! 'trazo> ! ;
:+trazo | p --
	trazo> !+ 0 over ! 'trazo> ! ;
:trazo!
	trazo> 4 - dup @ $f and rot or swap ! ;

:dibujotrazo
	'trazo @+
	0? ( 2drop ; )
	gc>xy op
	( @+ 1? )(
		gc>xy line ) 2drop
	;

:dibnodos | a--
	( @+ 1? )( gc>xy 2 box ) 2drop ;

:cldibujo
	'dibujoed 0 over ! 'dibujoed> !
	'indpol 0 over ! 'indpol> ! ;

:-dibujo | --
	-4 'dibujoed> +! ;

:+dibujo | p --
	dibujoed> !+ 'dibujoed> ! ;
:0dibujo
	0 dibujoed> ! ;

|----------------------------------------
:addline | agrega trazo a vesprite
	'trazo @+ 0? ( 2drop ; )
	8 or +dibujo
	( @+ 1? )( 9 or +dibujo ) 2drop ;

|----------------------------------------
#xcycwh 0 0 0 0

:savebox
	xc yc w h 'xcycwh !+ !+ !+ ! ;

:loadbox
	'xcycwh @+ 'h ! @+ 'w ! @+ 'yc ! @ 'xc ! ;

|----------------------------------------
:dibujando
	[ xymouse xy>gc +trazo ; ]
	[ addline -trazo ; ]
	guiDraw 
	dibujotrazo ;


:viewvesprite
	loadbox
	verde gc.box
	'dibujoed vesprite
	color ink

	dibujando

	;

:resetves
	cldibujo
	-trazo
	;


:elijecolor
	dlgcolora
	coloractual 'color !
	;

:editandoves  | --
	-trazo

	0 0 fpos
	sw sh 2dup max dup dim
	2/ 'yc ! 2/ 'xc !
	savebox

	33
	show clrscr
		|--- vista
		verde dup "%d " print

		viewvesprite


|		-0.9 0.9 fpos 0.08 hdim
|		todosmodos botonherra

|		-0.9 0.72 fpos 0.08 hdim
|		btncolor gcdn
|		violeta 'borrodib 'iborrar btnd gcdn
|		gris 'cambiofondo 'idiamante btnd gcdn
||		azul 'bmpback 'icopia btnd gcdn
|		azul [ 6 'modo ! ; ] 'icopia btnd gcdn

		|--- botonera
		48 qdim
		sw 32 - sh 32 - pos
		rojo 'exit dup >esc< btnb 'i.off drawric
		32 sh 32 - pos
		verde 'elijecolor btnb 'i.wrench drawric
		gc>>

		verde 'elijecolor btnb 'i.tint drawric
		gc>>
		verde 'elijecolor btnb 'i.pencil drawric
		gc>>
		verde 'elijecolor btnb 'i.search drawric


		cminiflecha ;


|--------------------------------------------------
:	mark $ffffff paper
	resetves
	'dibujoed "mem/notepad.ves" load 'dibujoed> !
	editandoves
	'dibujoed dibujoed> over - "mem/notepad.ves" save
	;
